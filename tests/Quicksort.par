
dec QuicksortGo: [List<Nat>] [List<Nat>] List<Nat>
def QuicksortGo = [input] [suffix] chan out: dual List<Nat> {
	input.unfounded@outer
	input.case {
		.item(pivot) => {
		}
		.end => { out <> suffix }
	}

	// now, split the rest of the list
	let a = List.Builder(type Nat)
	let b = List.Builder(type Nat)

	input.begin@inner.case {
		.item(i) => {
			let cmp = Nat.Compare(i, pivot)
			cmp.case {
				.less => { b.add(i) }
				else => { a.add(i) }
			}
			input.loop@inner
		}
		.end => {
			let suffix = chan out {
				let input = a.build
				input.loop@outer
			}
			let suffix = .item (pivot) suffix
			let input = b.build
			input.loop@outer
		}
	}
}

dec Quicksort: [List<Nat>] List<Nat>
def Quicksort = [x] QuicksortGo(x, .end!)

def BenchQuicksort = Quicksort(Bench.BlackBox(type List<Nat>)(
    *(83, 158, 640, 572, 461, 247, 482, 98, 586, 316, 251, 53, 980, 361, 305, 558, 380, 868, 271, 457, 467, 443, 119, 177, 593, 795, 286, 178, 265, 524, 386, 692, 954, 493, 657, 430, 112, 442, 873, 501, 389, 315, 541, 579, 918, 698, 196, 972, 368, 25, 788, 411, 915, 677, 352, 455, 201, 730, 163, 939, 292, 965, 0, 695, 879, 875, 755, 215, 604, 153, 716, 776, 157, 702, 723, 468, 816, 583, 621, 571, 560, 773, 447, 901, 302, 484, 854, 370, 722, 568, 101, 546, 76, 90, 678, 81, 502, 393, 751, 54, 346, 421, 964, 763, 224, 676, 454, 426, 813, 761, 237, 519, 907, 360, 849, 655, 438, 855, 888, 95, 436, 797, 846, 121, 841, 470, 733, 10, 639, 780, 35, 756, 337, 970, 700, 202, 569, 96, 187, 826, 810, 646, 838, 982, 191, 60, 449, 309, 362, 919, 452, 102, 310, 343, 437, 428, 31, 850, 729, 294, 58, 2, 278, 406, 963, 341, 966, 991, 293, 832, 485, 935, 938, 77, 725, 636, 146, 29, 748, 256, 134, 488, 510, 59, 784, 431, 906, 335, 959, 139, 404, 394, 160, 392, 350, 697, 214, 298, 891, 116, 634, 418, 977, 388, 242, 50, 405, 141, 601, 74, 896, 264, 880, 805, 230, 111, 869, 726, 248, 472, 128, 591, 126, 923, 357, 952, 956, 620, 644, 104, 205, 984, 517, 527, 86, 220, 656, 254, 233, 847, 44, 416, 326, 674, 138, 319, 464, 397, 106, 666, 989, 749, 754, 12, 344, 981, 823, 803, 383, 13, 192, 333, 997, 596, 382, 967, 463, 633, 165, 545, 323, 686, 664, 245, 209, 103, 578, 627, 318, 37, 859, 514, 466, 290, 667, 933, 973, 592, 720, 480, 511, 328, 882, 164, 297, 549, 113, 971, 738, 811, 883, 407, 105, 11, 589, 897, 665, 629, 573, 673, 174, 204, 770, 900, 479, 30, 994, 985, 356, 263, 63, 953, 642, 762, 200, 986, 975, 369, 908, 631, 800, 614, 372, 303, 554, 441, 864, 710, 15, 422, 108, 324, 609, 518, 234, 992, 135, 425, 520, 990, 851, 427, 179, 734, 186, 274, 71, 78, 774, 946, 14, 261, 507, 16, 624, 85, 446, 619, 822, 597, 792, 154, 291, 894, 581, 862, 913, 72, 539, 513, 257, 398, 381, 566, 532, 221, 410, 483, 123, 538, 931, 508, 790, 285, 829, 551, 284, 830, 364, 584, 807, 42, 444, 79, 142, 548, 193, 269, 843, 152, 496, 243, 556, 366, 458, 489, 218, 958, 491, 391, 49, 945, 663, 181, 241, 244, 599, 439, 459, 653, 654, 590, 932, 1, 659, 708, 250, 957, 236, 893, 207, 775, 818, 757, 97, 661, 812, 84, 149, 616, 486, 746, 743, 831, 308, 190, 842, 835, 429, 951, 413, 222, 336, 731, 735, 273, 637, 699, 474, 307, 8, 199, 414, 100, 170, 819, 376, 877, 262, 767, 747, 107, 295, 969, 34, 872, 32, 799, 432, 492, 658, 82, 858, 623, 140, 9, 688, 66, 892, 168, 211, 235, 886, 622, 916, 694, 921, 288, 351, 610, 742, 353, 903, 217, 557, 905, 403, 20, 118, 17, 837, 902, 340, 358, 69, 711, 594, 930, 24, 512, 267, 647, 764, 804, 435, 887, 475, 547, 641, 713, 57, 129, 529, 258, 373, 834, 845, 374, 917, 603, 866, 796, 477, 169, 909, 937, 911, 423, 874, 870, 433, 552, 412, 876, 960, 448, 962, 124, 363, 758, 434, 515, 783, 456, 844, 608, 115, 941, 122, 255, 197, 787, 533, 65, 56, 401, 777, 503, 825, 974, 45, 147, 173, 495, 465, 540, 927, 772, 925, 615, 670, 612, 544, 736, 613, 445, 574, 587, 229, 950, 246, 782, 650, 895, 275, 926, 979, 312, 652, 709, 188, 276, 814, 23, 922, 378, 976, 714, 133, 239, 561, 521, 52, 559, 306, 150, 390, 55, 924, 396, 582, 555, 929, 252, 789, 567, 409, 313, 820, 635, 771, 183, 283, 27, 473, 863, 732, 852, 3, 277, 481, 6, 815, 626, 143, 75, 827, 180, 602, 648, 249, 836, 338, 487, 225, 162, 334, 51, 331, 715, 617, 638, 469, 377, 671, 890, 904, 607, 185, 947, 821, 387, 450, 999, 451, 993, 809, 718, 148, 62, 570, 5, 440, 509, 228, 779, 311, 342, 460, 21, 281, 889, 7, 110, 206, 598, 172, 109, 280, 724, 161, 41, 476, 167, 680, 684, 817, 87, 525, 745, 300, 839, 516, 371, 348, 881, 48, 226, 683, 884, 213, 978, 632, 588, 67, 543, 530, 660, 949, 943, 417, 910, 28, 332, 125, 791, 833, 43, 865, 253, 585, 928, 33, 420, 737, 339, 329, 768, 506, 998, 99, 375, 171, 68, 46, 301, 808, 750, 22, 744, 499, 327, 359, 314, 227, 365, 961, 706, 73, 151, 934, 155, 347, 92, 240, 856, 379, 355, 210, 40, 618, 690, 553, 19, 238, 741, 64, 117, 707, 208, 279, 685, 500, 399, 497, 672, 739, 282, 203, 266, 983, 462, 136, 824, 948, 565, 385, 498, 645, 156, 175, 216, 687, 384, 400, 801, 630, 871, 534, 828, 231, 781, 419, 321, 662, 219, 562, 166, 717, 914, 564, 415, 94, 195, 760, 505, 955, 753, 794, 299, 402, 577, 345, 857, 137, 131, 793, 759, 675, 26, 606, 189, 752, 611, 18, 36, 287, 531, 325, 93, 691, 580, 198, 270, 349, 563, 70, 550, 144, 595, 988, 867, 536, 740, 317, 995, 47, 223, 987, 786, 899, 145, 703, 912, 669, 522, 575, 576, 681, 38, 424, 322, 184, 537, 478, 535, 354, 860, 159, 272, 693, 628, 649, 320, 679, 769, 885, 4, 840, 494, 878, 898, 408, 80, 114, 920, 88, 704, 802, 701, 936, 798, 528, 728, 705, 523, 996, 668, 304, 765, 296, 942, 176, 91, 490, 212, 132, 968, 61, 39, 625, 395, 682, 600, 260, 289, 130, 712, 471, 719, 182, 853, 778, 89, 605, 944, 542, 727, 232, 766, 367, 120, 330, 268, 643, 127, 259, 689, 453, 526, 721, 696, 194, 940, 861, 785, 848, 651, 806, 504)
))
